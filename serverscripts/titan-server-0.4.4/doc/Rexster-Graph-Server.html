<!DOCTYPE html>

<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Rexster Graph Server</title>
    <link rel="stylesheet" href="./css/screen.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="./css/gollum.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="./css/syntax.css" type="text/css" charset="utf-8" />
    <script src="./javascript/jquery-1.4.2.min.js" type="text/javascript"></script>
    <script src="./javascript/jquery.text_selection-1.0.0.min.js" type="text/javascript"></script>
    <script src="./javascript/jquery.previewable_comment_form.js" type="text/javascript"></script>
    <script src="./javascript/jquery.tabs.js" type="text/javascript"></script>
    <script src="./javascript/gollum.js" type="text/javascript"></script>
  </head>

  <body>
    <div id="main">
      <div class="site">
        <div id="guides">
          <div class="guide">
            <div class="main">
              <div class="actions">
                <div>
                  <a href="./Home.html">Aurelius Titan</a>
                </div>
              </div>
              <h1>Rexster Graph Server</h1>
              <div class="content wikistyle gollum textile">
                <p><a href="http://rexster.tinkerpop.com"><img src="https://github.com/tinkerpop/rexster/raw/master/doc/images/rexster-logo.png" alt=""></a></p>
<p><a href="http://rexster.tinkerpop.com">Rexster</a> exposes any Titan graph database via a <span class="caps">JSON</span>-based <a href="https://github.com/tinkerpop/rexster/wiki/Basic-REST-API"><span class="caps">REST</span></a> interface and a binary protocol called <a href="https://github.com/tinkerpop/rexster/wiki/RexPro">RexPro</a>. Provided and custom algorithms (called <a href="https://github.com/tinkerpop/rexster/wiki/Rexster-Kibbles">Kibbles</a>) can be stored on the server, triggered via <span class="caps">HTTP</span>, and their results returned via <span class="caps">JSON</span>. Finally, Rexster provides an administration and visualization interface that can be accessed from most major web browsers.  Rexster and Titan can be separately downloaded and configured to work together, or they can be downloaded together through the <code>titan-server</code> distribution on the <a class="internal present" href="./Downloads.html">Downloads</a> page.</p>
<h2>The Benefits of Rexster</h2>
<p><a href="https://github.com/tinkerpop/rexster/raw/master/doc/images/rexster-dog-house-viz.png"><img src="https://github.com/tinkerpop/rexster/raw/master/doc/images/rexster-dog-house-viz.png" width="434px"></a><a href="https://github.com/tinkerpop/rexster/raw/master/doc/images/rexster-dog-house-gremlin.png"><img src="https://github.com/tinkerpop/rexster/raw/master/doc/images/rexster-dog-house-gremlin.png" width="450px"></a></p>
<p>The following is a list of the <a href="https://github.com/tinkerpop/rexster/wiki/The-Benefits-of-Rexster">benefits of using Rexster</a>.</p>
<ul>
<li>
<a href="https://github.com/tinkerpop/rexster/wiki/Mapping-a-URI-to-JSON"><span class="caps">JSON</span>-based <span class="caps">REST</span> interface</a> ensures language agnostic connectivity to Titan.
	<ul>
<li>See <a href="http://bulbflow.com/">Bulbs</a> or <a href="https://github.com/StartTheShift/thunderdome">thunderdome</a> for a Python connector.</li>
	</ul>
</li>
	<li>
<span class="caps">HTML</span>/JavaScript <a href="https://github.com/tinkerpop/rexster/wiki/The-Dog-House">graphical user interface</a> for graph administration and visualization.</li>
	<li>Extend with more RESTful endpoints by adding <a href="https://github.com/tinkerpop/rexster/wiki/Creating-an-Extension">kibbles</a> to Rexster.
	<ul>
<li>See <a href="https://github.com/tinkerpop/rexster/wiki/Rexster-Kibbles">Rexster-Kibbles</a> provided by TinkerPop.</li>
	</ul>
</li>
	<li>Remote Gremlin traversals via the <a href="https://github.com/tinkerpop/rexster/wiki/Gremlin-Extension">Gremlin extensions</a> and the <a href="https://github.com/tinkerpop/rexster/wiki/Rexster-Console">Rexster console</a>.</li>
	<li>
<a href="https://github.com/tinkerpop/rexster/wiki/Rexster-Security">Security support</a> via user authentification.</li>
</ul><h2>Downloading and Starting Rexster with TItan</h2>
<p>There are two ways to download and install Rexster with Titan.</p>
<p>To get started with Rexster and Titan quickly, consider the titan-server zip distribution.  This contains Rexster, Titan, Cassandra, and Elasticsearch in a single download, preconfigured to work together.  It also contains the convenience script <code>bin/titan.sh</code> to start and stop the Cassandra and Rexster services (ES runs embedded in the Titan + Rexster VM and doesn’t use a separate process).</p>
<p>To use Titan backends besides Cassandra and ES, or to run graph engines besides Titan within a shared Rexster server, download Rexster and Titan separately and then install Titan as a Rexster extension.</p>
<p>Each of these approaches is described below.</p>
<h3>Getting started quickly with titan-server.zip</h3>
<ul>
<li>Download a copy of the current <code>titan-server-$VERSION.zip</code> file from the <a class="internal present" href="./Downloads.html">Downloads</a> page.</li>
	<li>Unzip it and enter the <code>titan-server-$VERSION</code> directory</li>
	<li>Run <code>bin/titan.sh start</code> to start a Rexster server with Titan + Cassandra, or run <code>bin/titan.sh -c cassandra-es start</code> to start a Rexster server with Titan + Cassandra + Elasticsearch.</li>
	<li>Connect to Rexster using <code>bin/rexster-console.sh</code>, the <span class="caps">REST</span> <span class="caps">API</span>, or an application using RexsterClient (each method is described below in the “Connecting to Rexster” section)</li>
	<li>Run <code>bin/titan.sh status</code> to check on the forked processes and <code>bin/titan.sh stop</code> to kill them</li>
</ul><p><strong><span class="caps">NOTE</span></strong> – The Rexster working directory is in <code>TITAN_HOME/rexhome</code>.  Server-side Gremlin scripts should be defined in <code>rexster.xml</code> with a path starting from there.</p>
<h3>Downloading Rexster and Titan separately</h3>
<p>This section describes the process of downloading a stock Rexster distribution, testing it in its default configuration, and then installing and configuring Titan as an extension.</p>
<p>Rexster can be downloaded at <a href="https://github.com/tinkerpop/rexster/wiki/Downloads">this location</a>. Below is a snippet of shell commands that demonstrate the process for getting Rexster downloaded and started using a default configuration.</p>
<div class="highlight">
<pre><span class="nv">$ </span>curl -O -L http://tinkerpop.com/downloads/rexster/rexster-server-x.y.z.zip &gt; rexster-server-x.y.z.zip
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current ...
...
<span class="nv">$ </span>unzip rexster-server-x.y.z.zip
Archive:  rexster-server-x.y.z.zip
   creating: rexster-server-x.y.z/
...
<span class="nv">$ </span><span class="nb">cd </span>rexster-server-x.y.z
<span class="nv">$ </span>./bin/rexster.sh --start
</pre>
</div>

<p>Validate that it is working by opening a browser and navigating to <code>http://localhost:8182</code> which should present a Rexster landing page with links to the root of the <span class="caps">REST</span> <span class="caps">API</span> and to the Dog House.</p>
<p>Use <code>CTRL-C</code> to kill the server. Now that Rexster is downloaded and verified to be working, it is necessary to configure Rexster to work with Titan.</p>
<h4>Configuring Rexster to use Titan</h4>
<p>This section explains how to configure Rexster to use a Titan graph database (see also Rexster’s <a href="https://github.com/tinkerpop/rexster/wiki/Getting-Started">Getting Started</a> page).</p>
<p><em><span class="caps">PREREQUISITE</span>:</em> These instructions assume that a graph has been created in Titan as described in the “Loading Data Into Titan” section of the <a class="internal present" href="./Getting-Started.html">Getting Started</a> page.</p>
<p>Edit the <code>REXSTER_HOME/rexster.xml</code> and include the Titan configuration portion in the <code>graphs</code> section (see <a href="https://github.com/tinkerpop/rexster/wiki/Rexster-Configuration">Rexster Configuration</a>).</p>
<div class="highlight">
<pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;rexster&gt;</span>
  ...
  <span class="nt">&lt;graphs&gt;</span>
    <span class="nt">&lt;graph&gt;</span>
      <span class="nt">&lt;graph-name&gt;</span>titanexample<span class="nt">&lt;/graph-name&gt;</span>
      <span class="nt">&lt;graph-type&gt;</span>com.thinkaurelius.titan.tinkerpop.rexster.TitanGraphConfiguration<span class="nt">&lt;/graph-type&gt;</span>
      <span class="nt">&lt;graph-location&gt;</span>/tmp/titan<span class="nt">&lt;/graph-location&gt;</span>
      <span class="nt">&lt;graph-read-only&gt;</span>false<span class="nt">&lt;/graph-read-only&gt;</span>
      <span class="nt">&lt;properties&gt;</span>
            <span class="nt">&lt;storage.backend&gt;</span>local<span class="nt">&lt;/storage.backend&gt;</span>
            <span class="nt">&lt;storage.buffer-size&gt;</span>100<span class="nt">&lt;/storage.buffer-size&gt;</span>
      <span class="nt">&lt;/properties&gt;</span>
      <span class="nt">&lt;extensions&gt;</span>
        <span class="nt">&lt;allows&gt;</span>
          <span class="nt">&lt;allow&gt;</span>tp:gremlin<span class="nt">&lt;/allow&gt;</span>
        <span class="nt">&lt;/allows&gt;</span>
      <span class="nt">&lt;/extensions&gt;</span>
    <span class="nt">&lt;/graph&gt;</span>
  <span class="nt">&lt;/graphs&gt;</span>
<span class="nt">&lt;/rexster&gt;</span>
</pre>
</div>

<p><span class="float-right"><span><img src="https://github.com/tinkerpop/rexster/raw/master/doc/images/rexster-character-2.png" width="100px"></span></span></p>
<p>Rexster’s <em>graph-location</em> option is equivalent to Titan’s <em>storage.directory</em>. In the event that Titan is being configured for “local” mode, please make sure that this value is an existing directory.  All other Titan specific configurations are subsumed under <em>properties</em>. In the example above, the backend and the buffer size are configured. Any of the <a href="Graph-Configuration">Titan configurations</a> can be used here.</p>
<p>Rexster needs to have Titan and its related library dependencies made available to it.  Rexster has an <code>ext</code> directory where <a href="https://github.com/tinkerpop/rexster/wiki/Extensions">extensions</a> and other related libraries can be put on Rexster’s path for <a href="https://github.com/tinkerpop/rexster/wiki/Deploying-an-Extension">deployment</a>.  All files in the root of that directory and sub-directories will be added to Rexster’s classpath.</p>
<p>To add Titan to Rexster, first make a directory as in:</p>
<div class="highlight">
<pre>mkdir REXSTER_HOME/ext/titan
</pre>
</div>

<p>Then, if building Titan from source:</p>
<div class="highlight">
<pre>cp TITAN_HOME/target/titan-x.y.z-standalone/lib/*.* REXSTER_HOME/ext/titan
</pre>
</div>

<p>or, if using the Titan zipped distribution download (use the titan-server distribution — it contains necessary classes for Titan-Rexster integration):</p>
<div class="highlight">
<pre>cp TITAN_HOME/lib/*.* REXSTER_HOME/ext/titan
</pre>
</div>

<p>Start Rexster with:</p>
<div class="highlight">
<pre>rexster$ bin/rexster.sh -s -c rexster.xml
</pre>
</div>

<p>Access the Titan graph at the following <span class="caps">URI</span>:</p>
<div class="highlight">
<pre>http://localhost:8182/graphs/titanexample
</pre>
</div>

<p><strong><span class="caps">NOTE</span></strong> – For those using ElasticSearch, Rexster includes lucene-core-3.5.0.jar (a neo4j dependency).  Assuming Neo4j is not being utilized in the Rexster instance, simply delete that file from the rexster <code>lib</code> directory.  Removing it will eliminate a conflict with Titan and allow ElasticSearch to start.</p>
<p><strong><span class="caps">NOTE</span></strong> – It is important to ensure that the <code>titan-rexster.jar</code> is in the <code>ext</code> directory as it is not available in all Titan distributions.</p>
<h2>Connecting to Rexster</h2>
<p>Regardless of the download and installation method chosen above, Rexster accepts connections through either RexPro or the <span class="caps">REST</span> <span class="caps">API</span> once started.</p>
<h3>Connect via rexster-console.sh</h3>
<p>Start <a href="https://github.com/tinkerpop/rexster/wiki/Rexster-Console">Rexster Console</a> with the default settings (127.0.0.0:8184) and then call <code>rexster.getGraph("graph")</code> to retrieve a Titan graph instance reference.</p>
<pre><code>$  bin/rexster-console.sh 
        (l_(l
(_______( 0 0
(        (-Y-) &lt;woof&gt;
l l-----l l
l l,,   l l,,
opening session [127.0.0.1:8184]
[INFO] EngineController - ScriptEngineManager has factory for: ECMAScript
[INFO] EngineController - ScriptEngineManager has factory for: Groovy
[INFO] EngineController - ScriptEngineManager has factory for: gremlin-groovy
[INFO] EngineController - Registered ScriptEngine for: gremlin-groovy
[INFO] EngineHolder - Initializing gremlin-groovy engine with additional imports.
[INFO] RexProSessions - RexPro Session created: 06885b49-71c4-49e6-9cc5-bd42b8c59740
?h for help

rexster[groovy]&gt; g = rexster.getGraph("graph")
==&gt;titangraph[cassandra:null]
rexster[groovy]&gt; g.getClass()
==&gt;class com.thinkaurelius.titan.graphdb.database.StandardTitanGraph
rexster[groovy]&gt; </code></pre>
<h3>Connecting to the <a href="https://github.com/tinkerpop/rexster/wiki/Basic-REST-API">REST API</a>
</h3>
<pre><code>curl http://localhost:8182/graphs</code></pre>
<div class="highlight">
<pre><span class="p">{</span>
    <span class="s2">"version"</span><span class="o">:</span> <span class="s2">"x.y.z"</span><span class="p">,</span>
    <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Rexster: A Graph Server"</span><span class="p">,</span>
    <span class="s2">"graphs"</span><span class="o">:</span> <span class="p">[</span>
        <span class="s2">"graph"</span>
    <span class="p">],</span>
    <span class="s2">"queryTime"</span><span class="o">:</span> <span class="mf">0.217059</span><span class="p">,</span>
    <span class="s2">"upTime"</span><span class="o">:</span> <span class="s2">"0[d]:00[h]:00[m]:05[s]"</span>
<span class="p">}</span>
</pre>
</div>

<h3>Connecting using RexsterClient</h3>
<p><a href="https://github.com/tinkerpop/rexster/wiki/RexPro-Java">RexsterClient</a> uses RexPro to talk to the Rexster server.  Here’s sample code that uses RexsterClient to issue a query over a <a href="https://github.com/thinkaurelius/titan/wiki/Getting-Started">Graph of the Gods</a>.</p>
<div class="highlight">
<pre><span class="n">RexsterClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">RexsterClientFactory</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">,</span> <span class="s">"graph"</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="n">result</span><span class="o">;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="s">"g.V('name','saturn').in('father').map"</span><span class="o">);</span>
<span class="c1">// result.toString(): [{name="jupiter", type="god"}]</span>

<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span><span class="s">"saturn"</span><span class="o">);</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="s">"g.V('name',name).in('father').map"</span><span class="o">,</span><span class="n">params</span><span class="o">);</span>
<span class="n">client</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</pre>
</div>

<p>First above, a connection to the Titan Server is established. Gremlin queries are issued as strings using the <code>RexsterClient.execute()</code> methods. Each query is executed in its own transaction. Explicit transaction handling is not necessary. The result set is a list of query answers, where each query answer is represented as a map of key-value pairs. <code>RexsterClient</code> provides additional <code>execute()</code> methods where the signature of each query answer can be specified as a template. The second query is semantically identical to the first, but in this case we are passing in the name as a variable binding for the corresponding variable used in the query. Once all queries have been issued, the connection is closed.</p>
<h2>Limitations</h2>
<p>Rexster has a rich <a href="https://github.com/tinkerpop/rexster/wiki/Basic-REST-API"><span class="caps">API</span></a> for working with Blueprints Graph implementations, but there are some limitations to consider when using Rexster with Titan:</p>
<ul>
<li>Titan automatically assigns identifiers. Hence, the <span class="caps">POST</span> of an edge cannot be done with an identifier. In other words, <span class="caps">POST</span> to this: <code>http://localhost/graphs/titan/edges</code> and <em>not</em> to this <code>http://localhost/graphs/titan/edges/1234</code>.</li>
	<li>Titan uses key indices and does not support manual indices. Hence, all operations on the <code>indices</code> resource are not supported. Use key indexes instead.</li>
</ul>
              </div>
            </div>
          </div>
          <div class="admin">
            <div style="float: left;">
              <small>Last edited by <b>Dan LaRocque</b>, 2014-04-22 09:02:35</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
